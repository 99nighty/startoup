/* SELECT ALL */

-- 사용자 테이블 전체 조회
SELECT * FROM USER_TABLES;

SELECT * FROM MEMBERS;
SELECT * FROM PRODUCT;
SELECT * FROM MYLIKE;
SELECT * FROM LISTS;
SELECT * FROM CRAWLING;
SELECT * FROM MYFUNDING;

/* UPDATE */


/* DELETE */
DELETE FROM PRODUCT WHERE P_NUM =101;


/* Query */
SELECT M_ID, M_PW, M_NAME, M_EMAIL1, M_EMAIL2, M_NUM, M_REGDATE FROM MEMBERS WHERE M_ID='admin' AND M_PW='1234'

UPDATE PRODUCT P 
SET P.P_INFO = (SELECT C.C_INFO FROM CRAWLING C WHERE P.P_NAME = C.C_NAME);

SELECT COUNT(*) FROM MYLIKE ML WHERE ML_MID = 'admin';

SELECT COUNT(*) FROM MYLIKE ML WHERE ML_MID = 'admin';
SELECT COUNT(*) FROM MYLIKE ML WHERE = (SELECT * FROM MYLIKE ML, MEMBERS M WHERE ML.ML_MID = M.M_ID);

SELECT COUNT(ML_NUM) FROM MYLIKE ML WHERE ML_MID='admin';

/* Sample Data */

-- CRAWLING

INSERT INTO CRAWLING(C_NUM, C_NAME, C_INFO) VALUES(1, '지구', '지구의 크롤링 데이터');
INSERT INTO CRAWLING(C_NUM, C_NAME, C_INFO) VALUES( (SELECT NVL(MAX(C_NUM), 0) + 1 FROM CRAWLING), '북두칠성', '북두칠성의 크롤링 데이터');

-- PROUDCT
INSERT INTO PRODUCT( P_NUM, P_NAME, P_PRICE, P_INFO, P_IMAGE, P_AMOUNT) VALUES( '101', '지구', '3000', '푸른별' , 'DEFAULT.jpg', '9000');
INSERT INTO PRODUCT( P_NUM, P_NAME, P_PRICE, P_INFO, P_IMAGE, P_AMOUNT) VALUES( (SELECT NVL(MAX(P_NUM), 0) + 1 FROM PRODUCT), '북두칠성', '5000', '일곱별' , 'DEFAULT.jpg', '20000');

-- MEMBERS 
INSERT INTO MEMBERS(M_ID, M_PW, M_NAME, M_EMAIL1, M_EMAIL2, M_NUM, M_REGDATE) VALUES('admin','1234','관리자','admin','naver.com','010-0000-0000',to_char(sysdate,'rr.mm.dd'));
	
-- LISTS
SELECT COUNT(L_NUM) FROM LISTS WHERE L_PID=101;
INSERT INTO LISTS(L_NUM, L_PID, L_MID) VALUES( '101', '101', 'admin');
INSERT INTO LISTS(L_NUM, L_PID, L_MID) VALUES( (SELECT NVL(MAX(L_NUM), 0) + 1 FROM LISTS), '101', 'admin3');

-- MYLIKE
INSERT INTO MYLIKE VALUES(1, 'admin', 1);
INSERT INTO MYLIKE VALUES(2	, 'admin', 2);

/* Create Tables */
	
CREATE TABLE MEMBERS
(
	M_ID varchar2(20) NOT NULL,
	M_PW varchar2(30) NOT NULL,
	M_NAME varchar2(20) NOT NULL,
	M_EMAIL1 varchar2(30) NOT NULL,
	M_EMAIL2 varchar2(30) NOT NULL,
	M_NUM varchar2(20) NOT NULL,
	M_REGDATE date NOT NULL,
	PRIMARY KEY (M_ID)
);

CREATE TABLE PRODUCT
(
	P_NUM number NOT NULL,
	P_NAME varchar2(50) NOT NULL,
	P_PRICE number NOT NULL,
	P_INFO varchar2(4000),
	P_FINISH number DEFAULT 0 NOT NULL,
	P_IMAGE varchar2(3000),
	P_AMOUNT number NOT NULL,
	P_CRNAMOUNT number DEFAULT 0 NOT NULL,
	P_PERCENT number DEFAULT 0 NOT NULL,
	PRIMARY KEY (P_NUM)
);

CREATE TABLE MYLIKE
(
	ML_NUM number NOT NULL,
	ML_MID varchar2(20) NOT NULL,
	ML_PID number NOT NULL,
	PRIMARY KEY (ML_NUM)
);

CREATE TABLE CRAWLING
(
	C_NUM number NOT NULL,
	C_NAME varchar2(50) NOT NULL,
	C_INFO varchar2(4000) NOT NULL,
	PRIMARY KEY (C_NUM)
);


CREATE TABLE LISTS
(
	L_NUM number NOT NULL,
	L_PID number NOT NULL,
	L_MID varchar2(20) NOT NULL,
	PRIMARY KEY (L_NUM)
);

CREATE TABLE MYFUNDING
(
	MF_NUM number NOT NULL,
	MF_MID varchar2(20) NOT NULL,
	MF_PID number NOT NULL,
	PRIMARY KEY (MF_NUM)
);


/* Create Foreign Keys */

ALTER TABLE LISTS
	ADD FOREIGN KEY (L_MID)
	REFERENCES MEMBERS (M_ID)
;


ALTER TABLE MYFUNDING
	ADD FOREIGN KEY (MF_MID)
	REFERENCES MEMBERS (M_ID)
;


ALTER TABLE MYLIKE
	ADD FOREIGN KEY (ML_MID)
	REFERENCES MEMBERS (M_ID)
;


ALTER TABLE CRAWLING
	ADD FOREIGN KEY (C_PID)
	REFERENCES PRODUCT (P_NUM)
;


ALTER TABLE LISTS
	ADD FOREIGN KEY (L_PID)
	REFERENCES PRODUCT (P_NUM)
;


ALTER TABLE MYFUNDING
	ADD FOREIGN KEY (MF_PID)
	REFERENCES PRODUCT (P_NUM)
;


ALTER TABLE MYLIKE
	ADD FOREIGN KEY (ML_PID)
	REFERENCES PRODUCT (P_NUM)
;


/* Drop Tables */

DROP TABLE CRAWLING CASCADE CONSTRAINTS;
DROP TABLE LISTS CASCADE CONSTRAINTS;
DROP TABLE MYFUNDING CASCADE CONSTRAINTS;
DROP TABLE MYLIKE CASCADE CONSTRAINTS;
DROP TABLE MEMBERS CASCADE CONSTRAINTS;
DROP TABLE PRODUCT CASCADE CONSTRAINTS;